We're trying out some fancy new security technologies on [our new site](http://host1.metaproblems.com:4200/)! We're excited to prove just how effective they are at keeping hackers like you out. Just to show you how secure we are, we invite you to try to take over the admin account. We'll even give you the admin's email: `admin@joywithtokens.metaproblems.com`. Good luck! You'll need it!

I have some idea but didn't solve it. Noticing that the website allows password reset and file upload, I immediately tried those two. The file upload does not have any protection added, so I could upload any file I want. The password reset uses url like the following one `http://host1.metaproblems.com:4200/reset.php?i=eyJqa3UiOiIuXC9rZXlzLmpzb24iLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJpYXQiOjE2MDM5MTg0NjEsIm5iZiI6MTYwMzkxODQ2MSwidXNlciI6ImNhdm94ZWM1NTJAbGx1YmVkLmNvbSJ9.oXozaTpahy1GNnJI8zSXT4hP-Hnzlp8XqHyMZspvDDxvUNWIuP0lT3JXfQYkQIfAQgrDvpSHtzcRqQ-5ed8vUhtp5Ik-OddUhA0PyVbixQju-ceteqqItrC46pL5yugqH___SpnLSRPYrJSh7F3Bh1j6BOTsuDmQPW55PNvOokQD4dEIXnq-s7vqAikAxLRDrkynSJSdGetC6ERNUjur3m3GJAnffgOrvJ-w-72k3vwjhfuQovg5mEqnYWxRZA78P-ENqDk3sMQAypbCdNzPBOD2szXPuOScWgv9OKEqVEUrQ53qrqmbApW6zzrqHrYZHMnZxpWF0FRS2aW2bnHG3Q` It uses the token to verify the user and renders a reset page for the user. So we should be able to forge a token so that we can reset the admin's password. But I had no idea what's kind of the token. It turns out to be JWT which is a very common verification  token.  The solution is realy clever. The official [write up](https://www.uzpg.me/cyber-security/2020/10/26/writeups-for-metactf-2020#joy-with-tokens) is here. 

